# Trending Worker 配置
# 复制此文件为 wrangler.trending.toml 并填入你的配置
# 定时计算 trending 分数

name = "skillscat-trending"
main = "workers/trending.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

# Cron Trigger - 每小时计算一次 trending 分数
[triggers]
crons = ["0 * * * *"]

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "skillscat-db"
database_id = "<your-database-id>"

# R2 Storage - 生成缓存列表
[[r2_buckets]]
binding = "R2"
bucket_name = "skillscat-storage"

# KV Namespace - 读取需要更新的标记
[[kv_namespaces]]
binding = "KV"
id = "<your-kv-namespace-id>"

[vars]
TRENDING_DECAY_HOURS = "72"
TRENDING_STAR_WEIGHT = "1.0"
TRENDING_FORK_WEIGHT = "2.0"
TRENDING_VIEW_WEIGHT = "0.1"

[env.production]
name = "skillscat-trending-production"

[env.production.triggers]
crons = ["0 * * * *"]

[[env.production.d1_databases]]
binding = "DB"
database_name = "skillscat-db"
database_id = "<your-production-database-id>"

[[env.production.r2_buckets]]
binding = "R2"
bucket_name = "skillscat-storage"

[[env.production.kv_namespaces]]
binding = "KV"
id = "<your-production-kv-namespace-id>"

[env.production.vars]
TRENDING_DECAY_HOURS = "72"
TRENDING_STAR_WEIGHT = "1.0"
TRENDING_FORK_WEIGHT = "2.0"
TRENDING_VIEW_WEIGHT = "0.1"
